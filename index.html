<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Biztonsági Tippek</title>
    <!-- Tailwind CSS betöltése a gyors és modern stílusért -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Egyedi betűtípus és finom átmenetek a jobb felhasználói élményért */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .card {
            /* Átlátszó háttér a sötét témához */
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .btn {
            transition: background-color 0.3s, transform 0.2s;
        }
        .btn:hover {
            transform: translateY(-2px);
        }
        .btn:active {
            transform: translateY(0);
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex items-center justify-center p-4">

    <div class="w-full max-w-md mx-auto">

        <!-- EMAIL MEGADÁSA NÉZET -->
        <div id="login-view">
            <div class="card rounded-2xl p-8 shadow-2xl space-y-6">
                <h1 class="text-3xl font-bold text-center text-cyan-400">AI Biztonsági Tippek</h1>
                <p class="text-center text-gray-400">Add meg az email címed a belépéshez.</p>
                <div>
                    <label for="email-input" class="block text-sm font-medium text-gray-300 mb-2">Email cím</label>
                    <input type="email" id="email-input" placeholder="neved@example.com" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-cyan-500 focus:outline-none">
                </div>
                <button id="request-code-btn" class="w-full btn bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 rounded-lg shadow-lg">
                    Tovább
                </button>
                <p id="login-message" class="text-center text-red-400 text-sm h-4"></p>
            </div>
        </div>
        
        <!-- KÓD MEGADÁSA NÉZET (rejtett) -->
        <div id="code-view" class="hidden">
            <div class="card rounded-2xl p-8 shadow-2xl space-y-6">
                 <h1 class="text-3xl font-bold text-center text-cyan-400">Kód megerősítése</h1>
                 <p class="text-center text-gray-400">Elküldtünk egy kódot a(z) <span id="user-email-display" class="font-bold text-white"></span> címre.</p>
                 <p id="test-code-display" class="text-center bg-gray-800 p-2 rounded-md text-yellow-300"></p>
                 <div>
                    <label for="code-input" class="block text-sm font-medium text-gray-300 mb-2">Megerősítő kód</label>
                    <input type="text" id="code-input" placeholder="******" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 text-white text-center tracking-[0.5em] focus:ring-2 focus:ring-cyan-500 focus:outline-none">
                 </div>
                 <button id="verify-code-btn" class="w-full btn bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg shadow-lg">
                    Belépés
                </button>
                 <p id="code-message" class="text-center text-red-400 text-sm h-4"></p>
                 <button id="back-to-login-btn" class="text-center w-full text-sm text-gray-400 hover:text-white">Vissza</button>
            </div>
        </div>

        <!-- FELHASZNÁLÓI VEZÉRLŐPULT (rejtett) -->
        <div id="dashboard-view" class="hidden">
             <div class="card rounded-2xl p-8 shadow-2xl space-y-6">
                <div class="flex justify-between items-center">
                    <h1 class="text-2xl font-bold text-cyan-400">Tippek</h1>
                    <button id="user-logout-btn" class="btn bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg">Kilépés</button>
                </div>
                <!-- INGYENES TIPP SZEKCIÓ -->
                <div id="free-tip-section" class="space-y-4">
                    <h2 class="text-xl font-semibold text-center text-green-400">A nap ingyenes tippje</h2>
                    <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 text-center">
                        <p class="text-gray-400 text-sm mb-2">Mérkőzés</p>
                        <p class="text-xl font-bold"><span id="free-home-display">Nincs</span> vs <span id="free-away-display">megadva</span></p>
                        <div class="flex justify-around items-center mt-4">
                            <div>
                                <p class="text-gray-400 text-sm">Odds</p>
                                <p class="text-lg font-bold text-yellow-400" id="free-odds-display">-</p>
                            </div>
                            <div>
                                <p class="text-gray-400 text-sm">AI Tipp</p>
                                <p class="text-lg font-bold text-cyan-400" id="free-tip-display">-</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="border-t border-gray-700"></div>
                <!-- EGYÉB TIPPEK -->
                 <div id="user-cards-container" class="space-y-4 max-h-60 overflow-y-auto pr-2">
                    <!-- A dinamikusan generált kártyák helye -->
                </div>
            </div>
        </div>

        <!-- ADMIN NÉZET (alapból rejtett) -->
        <div id="admin-view" class="hidden">
             <div class="card rounded-2xl p-8 shadow-2xl space-y-6">
                <div class="flex justify-between items-center">
                    <h1 class="text-3xl font-bold text-orange-400">Admin Felület</h1>
                    <button id="admin-logout-btn" class="btn bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg">Kilépés</button>
                </div>
                <p id="admin-message" class="text-center text-green-400 h-4"></p>
                <!-- INGYENES TIPP BEÁLLÍTÁSA -->
                <div class="space-y-4 p-4 bg-gray-800 rounded-lg border border-gray-700">
                    <h2 class="text-xl font-semibold text-green-400">Ingyenes szelvény beállítása</h2>
                    <form id="free-tip-form" class="space-y-3">
                        <input type="text" id="free-home-input" placeholder="Hazai csapat" class="w-full bg-gray-700 border border-gray-600 rounded-md px-3 py-2 focus:ring-1 focus:ring-green-500 focus:outline-none">
                        <input type="text" id="free-away-input" placeholder="Vendég csapat" class="w-full bg-gray-700 border border-gray-600 rounded-md px-3 py-2 focus:ring-1 focus:ring-green-500 focus:outline-none">
                        <input type="text" id="free-odds-input" placeholder="Odds (pl. 1.85)" class="w-full bg-gray-700 border border-gray-600 rounded-md px-3 py-2 focus:ring-1 focus:ring-green-500 focus:outline-none">
                        <input type="text" id="free-tip-input" placeholder="AI Tipp (pl. Hazai győzelem)" class="w-full bg-gray-700 border border-gray-600 rounded-md px-3 py-2 focus:ring-1 focus:ring-green-500 focus:outline-none">
                        <button type="submit" class="w-full btn bg-green-600 hover:bg-green-700 text-white font-bold py-2 rounded-md">Ingyenes tipp mentése</button>
                    </form>
                </div>
                <!-- ÚJ KÁRTYA LÉTREHOZÁSA -->
                <div class="space-y-4 p-4 bg-gray-800 rounded-lg border border-gray-700">
                    <h2 class="text-xl font-semibold text-cyan-400">Új tipp kártya létrehozása</h2>
                    <form id="new-card-form" class="space-y-3">
                        <input type="text" id="card-home-input" placeholder="Hazai csapat" class="w-full bg-gray-700 border border-gray-600 rounded-md px-3 py-2 focus:ring-1 focus:ring-cyan-500 focus:outline-none">
                        <input type="text" id="card-away-input" placeholder="Vendég csapat" class="w-full bg-gray-700 border border-gray-600 rounded-md px-3 py-2 focus:ring-1 focus:ring-cyan-500 focus:outline-none">
                        <input type="text" id="card-odds-input" placeholder="Odds" class="w-full bg-gray-700 border border-gray-600 rounded-md px-3 py-2 focus:ring-1 focus:ring-cyan-500 focus:outline-none">
                        <input type="text" id="card-tip-input" placeholder="AI Tipp" class="w-full bg-gray-700 border border-gray-600 rounded-md px-3 py-2 focus:ring-1 focus:ring-cyan-500 focus:outline-none">
                        <button type="submit" class="w-full btn bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 rounded-md">Kártya hozzáadása</button>
                    </form>
                </div>
                <!-- LÉTREHOZOTT KÁRTYÁK -->
                <div id="cards-container" class="space-y-4 max-h-60 overflow-y-auto pr-2">
                    <!-- A dinamikusan generált kártyák helye -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // === VÁLTOZÓK ÉS DOM ELEMEK ===
        const ADMIN_EMAIL = "kriszaibot.tutti@gmail.com";

        // Nézetek
        const loginView = document.getElementById('login-view');
        const codeView = document.getElementById('code-view');
        const dashboardView = document.getElementById('dashboard-view');
        const adminView = document.getElementById('admin-view');

        // Login nézet elemei
        const emailInput = document.getElementById('email-input');
        const requestCodeBtn = document.getElementById('request-code-btn');
        const loginMessage = document.getElementById('login-message');

        // Kód nézet elemei
        const userEmailDisplay = document.getElementById('user-email-display');
        const testCodeDisplay = document.getElementById('test-code-display');
        const codeInput = document.getElementById('code-input');
        const verifyCodeBtn = document.getElementById('verify-code-btn');
        const codeMessage = document.getElementById('code-message');
        const backToLoginBtn = document.getElementById('back-to-login-btn');
        
        // Felhasználói dashboard elemek
        const userLogoutBtn = document.getElementById('user-logout-btn');
        const freeHomeDisplay = document.getElementById('free-home-display');
        const freeAwayDisplay = document.getElementById('free-away-display');
        const freeOddsDisplay = document.getElementById('free-odds-display');
        const freeTipDisplay = document.getElementById('free-tip-display');
        const userCardsContainer = document.getElementById('user-cards-container');

        // Admin nézet elemek
        const adminLogoutBtn = document.getElementById('admin-logout-btn');
        const adminMessage = document.getElementById('admin-message');
        const freeTipForm = document.getElementById('free-tip-form');
        const newCardForm = document.getElementById('new-card-form');
        const cardsContainer = document.getElementById('cards-container');

        // Adattárolás (Mivel ez egy statikus app, az adatokat a memóriában tároljuk. Vercelre való feltöltés után ezek az adatok nem maradnak meg az oldal frissítésekor. Lásd a javaslatot az oldal alján a Firebase-re!)
        let generatedCode = '';
        // Alapértelmezett kezdő tippek
        let freeTipData = { 
            home: "Fradi", 
            away: "Újpest", 
            odds: "1.50", 
            tip: "Hazai győzelem" 
        };
        let tipCardsData = [
            { home: "Real Madrid", away: "Barcelona", odds: "2.10", tip: "Mindkét csapat gólt szerez" },
            { home: "Bayern München", away: "Dortmund", odds: "1.75", tip: "Több mint 2.5 gól" }
        ];

        // === FUNKCIÓK ===

        function showView(viewToShow) {
            // Elrejti az összes nézetet, majd mutatja a kért nézetet
            [loginView, codeView, dashboardView, adminView].forEach(view => view.classList.add('hidden'));
            viewToShow.classList.remove('hidden');
        }

        function showMessage(element, text, isError = false) {
            element.textContent = text;
            element.className = `text-center text-sm h-4 ${isError ? 'text-red-400' : 'text-green-400'}`;
            // Mivel az admin üzenet zöld, a login/code hibaüzenet marad piros.
            if (element.id === 'admin-message') {
                element.className = `text-center text-sm h-4 ${isError ? 'text-red-400' : 'text-green-400'}`;
            } else {
                element.className = `text-center text-sm h-4 ${isError ? 'text-red-400' : 'text-yellow-300'}`;
            }
            setTimeout(() => { element.textContent = ''; }, 3000);
        }

        function updateFreeTipDisplay() {
            freeHomeDisplay.textContent = freeTipData.home;
            freeAwayDisplay.textContent = freeTipData.away;
            freeOddsDisplay.textContent = freeTipData.odds;
            freeTipDisplay.textContent = freeTipData.tip;

            // Admin form beviteli mezők frissítése az aktuális adatokkal
            document.getElementById('free-home-input').value = freeTipData.home;
            document.getElementById('free-away-input').value = freeTipData.away;
            document.getElementById('free-odds-input').value = freeTipData.odds;
            document.getElementById('free-tip-input').value = freeTipData.tip;
        }

        function renderAdminCards() {
            cardsContainer.innerHTML = tipCardsData.length === 0 ? '<p class="text-center text-gray-500">Még nincs létrehozott kártya.</p>' : '';
            tipCardsData.forEach((card, index) => {
                cardsContainer.innerHTML += `
                    <div class="bg-gray-800 p-4 rounded-lg border border-gray-700 flex justify-between items-start">
                        <div>
                            <p class="text-lg font-bold">${card.home} vs ${card.away}</p>
                            <p class="text-sm text-cyan-400">AI Tipp: ${card.tip}</p>
                        </div>
                        <div class="text-right">
                           <p class="text-yellow-400 font-bold text-lg">${card.odds}</p>
                           <button onclick="deleteCard(${index})" class="text-xs text-red-500 hover:text-red-400 mt-2">Törlés</button>
                        </div>
                    </div>`;
            });
        }
        
        function renderUserCards() {
            userCardsContainer.innerHTML = tipCardsData.length === 0 ? '<p class="text-center text-gray-500">Nincsenek további tippek.</p>' : '';
            tipCardsData.forEach(card => {
                userCardsContainer.innerHTML += `
                    <div class="bg-gray-800 p-4 rounded-lg border border-gray-700 flex justify-between items-center">
                        <div>
                            <p class="font-bold">${card.home} vs ${card.away}</p>
                            <p class="text-sm text-cyan-400">${card.tip}</p>
                        </div>
                        <p class="text-yellow-400 font-bold text-lg">${card.odds}</p>
                    </div>`;
            });
        }

        window.deleteCard = function(index) {
            tipCardsData.splice(index, 1);
            renderAdminCards();
        }

        function logout() {
            emailInput.value = '';
            codeInput.value = '';
            generatedCode = ''; // Töröljük a kódot is
            showView(loginView);
        }

        // === ESEMÉNYKEZELŐK ===

        requestCodeBtn.addEventListener('click', () => {
            const email = emailInput.value.trim().toLowerCase();
            loginMessage.textContent = '';
            codeMessage.textContent = '';

            if (!email || !email.includes('@')) {
                showMessage(loginMessage, 'Kérlek, adj meg egy érvényes email címet!', true);
                return;
            }

            // Admin belépés
            if (email === ADMIN_EMAIL) {
                showView(adminView);
                updateFreeTipDisplay(); // Frissíti a beviteli mezőket is
                renderAdminCards();
            } else {
                // Felhasználói belépés (kódgenerálás)
                generatedCode = Math.random().toString(36).substring(2, 8).toUpperCase();
                userEmailDisplay.textContent = email;
                testCodeDisplay.innerHTML = `Teszteléshez használd a kódot: <span class="font-mono font-extrabold text-xl text-yellow-300">${generatedCode}</span>`;
                codeInput.value = ''; // Kód mező ürítése
                showView(codeView);
            }
        });

        verifyCodeBtn.addEventListener('click', () => {
            codeMessage.textContent = '';
            if (codeInput.value.toUpperCase() === generatedCode) {
                showView(dashboardView);
                updateFreeTipDisplay();
                renderUserCards();
            } else {
                showMessage(codeMessage, 'Hibás kód!', true);
            }
        });
        
        backToLoginBtn.addEventListener('click', () => showView(loginView));
        
        userLogoutBtn.addEventListener('click', logout);
        adminLogoutBtn.addEventListener('click', logout);

        freeTipForm.addEventListener('submit', (e) => {
            e.preventDefault();
            freeTipData.home = document.getElementById('free-home-input').value.trim();
            freeTipData.away = document.getElementById('free-away-input').value.trim();
            freeTipData.odds = document.getElementById('free-odds-input').value.trim();
            freeTipData.tip = document.getElementById('free-tip-input').value.trim();
            updateFreeTipDisplay(); // Frissíti a felhasználói nézetet és a beviteli mezőket
            showMessage(adminMessage, 'Ingyenes tipp sikeresen mentve!');
        });

        newCardForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const home = document.getElementById('card-home-input').value.trim();
            const away = document.getElementById('card-away-input').value.trim();
            const odds = document.getElementById('card-odds-input').value.trim();
            const tip = document.getElementById('card-tip-input').value.trim();
            
            if (home && away && odds && tip) {
                tipCardsData.push({ home, away, odds, tip });
                renderAdminCards();
                showMessage(adminMessage, 'Új kártya sikeresen hozzáadva!');
                newCardForm.reset();
            } else {
                showMessage(adminMessage, 'Minden mező kitöltése kötelező!', true);
            }
        });
        
        // === INICIALIZÁLÁS ===
        updateFreeTipDisplay();
        showView(loginView); // Kezdés a bejelentkezési nézettel

    </script>
</body>
</html>
