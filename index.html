<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Foci Tippelő Rendszer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0d1117; color: #c9d1d9; }
        .card { background-color: #161b22; border: 1px solid #30363d; }
        .btn { transition: all 0.2s ease-in-out; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); }
        .loader { width: 24px; height: 24px; border: 3px solid #30363d; border-bottom-color: #58a6ff; border-radius: 50%; display: inline-block; box-sizing: border-box; animation: rotation 1s linear infinite; }
        @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .category-fix .card-header { border-left: 4px solid #28a745; } /* Green */
        .category-kozepes .card-header { border-left: 4px solid #ffc107; } /* Yellow */
        .category-nagy-tetes .card-header { border-left: 4px solid #dc3545; } /* Red */
    </style>
</head>
<body class="p-4 md:p-8">

    <main class="max-w-7xl mx-auto space-y-8">
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
            <div>
                <h1 class="text-3xl md:text-4xl font-bold text-white">AI Tippelő Rendszer</h1>
                <p class="text-slate-400 mt-1">Napi 9 tipp, AI által kategorizálva és elemezve.</p>
            </div>
            <div class="flex items-center gap-4">
                <div class="card p-3 rounded-lg text-center">
                    <p class="text-xs font-semibold text-slate-400">ROI (szimulált)</p>
                    <p id="roi-stat" class="text-lg font-bold text-green-400">+7.8%</p>
                </div>
                <div class="card p-3 rounded-lg text-center">
                    <p class="text-xs font-semibold text-slate-400">Találati Arány</p>
                    <p id="winrate-stat" class="text-lg font-bold text-sky-400">68%</p>
                </div>
            </div>
        </header>

        <div class="text-center space-y-4">
            <h2 id="tips-date-header" class="text-xl font-semibold text-slate-300"></h2>
            <button id="generate-tips-btn" class="btn bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg">
                Mai Tippek Lekérése
            </button>
        </div>

        <div id="tips-container" class="space-y-8">
            <!-- Tip categories will be injected here -->
        </div>

    </main>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- 1. SIMULATED API & BACKEND LOGIC ---

    const teamPool = [
        "Manchester Utd", "Liverpool", "Arsenal", "Chelsea", "Tottenham", "Manchester City",
        "Real Madrid", "Barcelona", "Atletico Madrid", "Sevilla", "Valencia", "Villarreal",
        "Bayern München", "Borussia Dortmund", "RB Leipzig", "Bayer Leverkusen", "Eintracht Frankfurt",
        "Juventus", "Inter Milan", "AC Milan", "AS Roma", "Napoli", "Lazio",
        "PSG", "Olympique Marseille", "AS Monaco", "Olympique Lyon"
    ];

    /**
     * Generates a single random football match with realistic odds.
     * @param {string} dateString - The date for the match.
     * @returns {object} A match object.
     */
    const generateRandomMatch = (dateString) => {
        const shuffledTeams = [...teamPool].sort(() => 0.5 - Math.random());
        const home = shuffledTeams[0];
        const away = shuffledTeams[1];
        
        const isBigFavorite = Math.random() > 0.6;
        let homeOdd, drawOdd, awayOdd;

        if (isBigFavorite) {
            homeOdd = 1.15 + Math.random() * 0.4; // 1.15 - 1.55
            drawOdd = 4.5 + Math.random() * 4;   // 4.5 - 8.5
            awayOdd = 6.0 + Math.random() * 10;  // 6.0 - 16.0
        } else {
            homeOdd = 1.60 + Math.random() * 1.2; // 1.60 - 2.80
            drawOdd = 3.20 + Math.random() * 1.0; // 3.20 - 4.20
            awayOdd = 2.50 + Math.random() * 2.0; // 2.50 - 4.50
        }
        
        return {
            home,
            away,
            date: dateString,
            odds: {
                "1": parseFloat(homeOdd.toFixed(2)),
                "X": parseFloat(drawOdd.toFixed(2)),
                "2": parseFloat(awayOdd.toFixed(2))
            }
        };
    };
    
    /**
     * Simulates fetching today's matches from a sports data API.
     * @param {string} dateString - The date for which to fetch matches.
     * @returns {Promise<Array>} A promise that resolves with an array of match objects.
     */
    const fetchTodaysMatchesFromAPI = (dateString) => {
        console.log("Szimuláció: Mai meccsek lekérése az API-tól...");
        return new Promise(resolve => {
            setTimeout(() => {
                const matches = [];
                for (let i = 0; i < 20; i++) { // Generate 20 random matches for the day
                    matches.push(generateRandomMatch(dateString));
                }
                console.log(`Szimuláció: ${matches.length} meccs sikeresen 'letöltve'.`);
                resolve(matches);
            }, 1000); // Simulate network delay
        });
    };

    /**
     * Simulates an AI model analyzing a single match.
     * @param {object} match - The match object with odds.
     * @returns {object} The analyzed match with AI probability and EV.
     */
    const runAIAnalysis = (match) => {
        const { odds } = match;
        const implied1 = 1 / odds["1"];
        const impliedX = 1 / odds["X"];
        const implied2 = 1 / odds["2"];
        const overround = implied1 + impliedX + implied2;

        // Simulate AI's "edge" - a small random deviation from the bookmaker's probability
        const aiProb1 = (implied1 / overround) * (1 + (Math.random() - 0.4) * 0.25);
        const aiProbX = (impliedX / overround) * (1 + (Math.random() - 0.4) * 0.25);
        const aiProb2 = (implied2 / overround) * (1 + (Math.random() - 0.4) * 0.25);

        // Normalize AI probabilities to sum to 1
        const aiTotalProb = aiProb1 + aiProbX + aiProb2;
        const finalAIProb1 = aiProb1 / aiTotalProb;
        const finalAIProbX = aiProbX / aiTotalProb;
        const finalAIProb2 = aiProb2 / aiTotalProb;

        // Find the most likely outcome and its EV
        let mostLikelyTip = "1";
        let highestProb = finalAIProb1;
        if (finalAIProbX > highestProb) { highestProb = finalAIProbX; mostLikelyTip = "X"; }
        if (finalAIProb2 > highestProb) { highestProb = finalAIProb2; mostLikelyTip = "2"; }

        const ev = (highestProb * odds[mostLikelyTip]) - 1;

        return { ...match, tip: mostLikelyTip, ai_prob: highestProb, ev: ev };
    };

    const getReason = (match) => {
        if (match.ai_prob > 0.8) return "Kiemelkedő forma és hazai pálya előny.";
        if (match.ev > 0.4) return "Erős piaci alulértékelés (magas EV).";
        if (match.ai_prob > 0.65) return "Stabil forma és xG mutatók alapján.";
        return "Kedvező oddsok a becsült valószínűséghez képest.";
    };
    
    /**
     * Main function to orchestrate fetching, analyzing, and categorizing tips.
     * @returns {Promise<object>} A promise that resolves with the categorized tips.
     */
    const generateAndCategorizeTips = async () => {
        const today = "2025-10-04";
        const todaysMatches = await fetchTodaysMatchesFromAPI(today);
        const analyzedMatches = todaysMatches.map(runAIAnalysis);

        const tips = {
            fix: [],
            kozepes: [],
            "nagy-tetes": [],
        };
        
        // Sort by a combined score of probability and value to find the best candidates
        analyzedMatches.sort((a, b) => (b.ai_prob + b.ev) - (a.ai_prob + a.ev));

        analyzedMatches.forEach(match => {
            const tipKey = match.tip;
            if (tips.fix.length < 3 && match.ai_prob > 0.80 && match.ev >= 0.05) {
                tips.fix.push({ ...match, selectedTip: tipKey, reason: getReason(match) });
            } else if (tips.kozepes.length < 3 && match.ai_prob >= 0.65 && match.ai_prob <= 0.80 && match.ev >= 0.10) {
                tips.kozepes.push({ ...match, selectedTip: tipKey, reason: getReason(match) });
            } else if (tips["nagy-tetes"].length < 3 && match.ai_prob >= 0.55 && match.ai_prob < 0.65 && match.ev >= 0.25) {
                tips["nagy-tetes"].push({ ...match, selectedTip: tipKey, reason: getReason(match) });
            }
        });

        return tips;
    };

    // --- 2. UI RENDERING ---

    const createTipCardHTML = (match) => {
        return `
            <div class="card rounded-lg p-4 space-y-3">
                <div class="flex justify-between items-center">
                    <p class="font-bold text-white">${match.home} - ${match.away}</p>
                    <p class="text-sm font-semibold bg-gray-700 px-2 py-1 rounded">${(match.odds[match.selectedTip]).toFixed(2)}</p>
                </div>
                <div>
                    <p class="font-bold text-lg text-sky-400">${match.selectedTip === "1" ? "Hazai győzelem" : (match.selectedTip === "X" ? "Döntetlen" : "Vendég győzelem")}</p>
                    <p class="text-sm text-slate-400">AI Valószínűség: <span class="font-semibold">${(match.ai_prob * 100).toFixed(0)}%</span></p>
                </div>
                <div class="text-xs text-gray-400 border-t border-gray-700 pt-2">
                    <p><span class="font-semibold text-gray-300">Elemzés:</span> ${match.reason}</p>
                </div>
            </div>
        `;
    };

    const renderTips = (tips) => {
        const container = document.getElementById('tips-container');

        if (tips.fix.length === 0 && tips.kozepes.length === 0 && tips['nagy-tetes'].length === 0) {
            container.innerHTML = `<div class="card text-center p-8 rounded-lg">
                <h2 class="text-xl font-semibold text-slate-300">A mai napra nincsenek elérhető AI tippek.</h2>
                <p class="text-slate-400 mt-2">Az AI nem talált elegendő értéket a mai piaci kínálatban.</p>
            </div>`;
            return;
        }

        container.innerHTML = `
            <section id="fix-tips" class="category-fix">
                <h2 class="text-2xl font-bold mb-4 text-green-400 card-header">Fix Tippek</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    ${tips.fix.map(createTipCardHTML).join('')}
                </div>
            </section>
            <section id="kozepes-tips" class="category-kozepes">
                <h2 class="text-2xl font-bold mb-4 text-yellow-400 card-header">Közepes Tétes Tippek</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    ${tips.kozepes.map(createTipCardHTML).join('')}
                </div>
            </section>
            <section id="nagy-tetes-tips" class="category-nagy-tetes">
                <h2 class="text-2xl font-bold mb-4 text-red-400 card-header">Nagy Tétes Tippek</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    ${tips['nagy-tetes'].map(createTipCardHTML).join('')}
                </div>
            </section>
        `;
    };
    
    // --- 3. EVENT LISTENERS ---

    document.getElementById('generate-tips-btn').addEventListener('click', async (e) => {
        const btn = e.currentTarget;
        const originalText = btn.innerHTML;
        btn.innerHTML = '<div class="loader mx-auto"></div>';
        btn.disabled = true;
        
        const today = new Date('2025-10-04');
        const formattedDate = today.toLocaleDateString('hu-HU', { year: 'numeric', month: 'long', day: 'numeric' });
        document.getElementById('tips-date-header').textContent = `Tippek a mai napra: ${formattedDate}`;

        try {
            const tips = await generateAndCategorizeTips();
            renderTips(tips);
        } catch (error) {
            console.error("Hiba a tippek generálása közben:", error);
            document.getElementById('tips-container').innerHTML = `<div class="card text-center p-8 rounded-lg"><h2 class="text-xl font-semibold text-red-400">Hiba történt.</h2><p class="text-slate-400 mt-2">Nem sikerült lekérni a mai tippeket. Kérlek, próbáld újra később.</p></div>`;
        } finally {
            btn.innerHTML = originalText;
            btn.disabled = false;
        }
    });

});
</script>

</body>
</html>

